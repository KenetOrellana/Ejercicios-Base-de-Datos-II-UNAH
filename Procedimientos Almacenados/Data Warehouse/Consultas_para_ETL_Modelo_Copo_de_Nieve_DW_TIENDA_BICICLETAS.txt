---------- CONSULTA PARA LA TABLA TIEMPO (TBL_TIEMPO) ------------
SELECT CONVERT(DATE, ORDER_DATE) TIEMPO_ID, DATENAME(MONTH, ORDER_DATE) NOMBRE_MES, DATEPART(WEEK, ORDER_DATE) SEMANA, 
DATEPART(QUARTER, ORDER_DATE) TRIMESTRE, CEILING(DATEPART(MM, ORDER_DATE)*1.0/4) CUATRIMESTRE, 
DATENAME(WEEKDAY, ORDER_DATE) DIA_DE_SEMANA FROM SALES.ORDERS
 
GROUP BY SALES.ORDERS.ORDER_DATE

---------- CONSULTA PARA LA TABLA PRODUCTOS (PRODUCTS) ------------
SELECT PRODUCTION.PRODUCTS.PRODUCT_ID, PRODUCTION.CATEGORIES.CATEGORY_ID, PRODUCTION.BRANDS.BRAND_ID, PRODUCTION.PRODUCTS.PRODUCT_NAME, PRODUCTION.PRODUCTS.MODEL_YEAR, PRODUCTION.CATEGORIES.CATEGORY_NAME, PRODUCTION.BRANDS.BRAND_NAME FROM PRODUCTION.PRODUCTS

INNER JOIN PRODUCTION.CATEGORIES ON PRODUCTION.CATEGORIES.CATEGORY_ID = PRODUCTION.PRODUCTS.CATEGORY_ID
INNER JOIN PRODUCTION.BRANDS ON PRODUCTION.BRANDS.BRAND_ID = PRODUCTION.PRODUCTS.BRAND_ID

GROUP BY PRODUCTION.PRODUCTS.PRODUCT_ID, PRODUCTION.CATEGORIES.CATEGORY_ID, PRODUCTION.BRANDS.BRAND_ID, PRODUCTION.PRODUCTS.PRODUCT_NAME, PRODUCTION.PRODUCTS.MODEL_YEAR, PRODUCTION.CATEGORIES.CATEGORY_NAME, PRODUCTION.BRANDS.BRAND_NAME

---------- CONSULTA PARA LA TABLA EMPLEADOS (STAFFS)  ------------
SELECT STAFF_ID, CONCAT(FIRST_NAME, ' ', LAST_NAME) NOMBRE_STAFF, RIGHT(EMAIL, 10) AS EMAIL FROM SALES.STAFFS

---------- CONSULTA PARA LA TABLA CLIENTES (CUSTOMERS) ------------
SELECT CUSTOMER_ID, CONCAT(FIRST_NAME, ' ', LAST_NAME) NOMBRE_CUSTOMER, CITY, STATE FROM SALES.CUSTOMERS

---------- CONSULTA PARA LA TABLA TIENDAS (STORES) ------------
SELECT STORE_ID, STORE_NAME FROM SALES.STORES

---------- CONSULTA PARA LA TABLA MARCAS (BRANDS) ------------
SELECT PRODUCTION.BRANDS.BRAND_ID, PRODUCTION.BRANDS.BRAND_NAME FROM PRODUCTION.BRANDS

GROUP BY PRODUCTION.BRANDS.BRAND_ID, PRODUCTION.BRANDS.BRAND_NAME

---------- CONSULTA PARA LA TABLA CATEGORIAS (CATEGORIES) ------------
SELECT PRODUCTION.CATEGORIES.CATEGORY_ID, PRODUCTION.CATEGORIES.CATEGORY_NAME FROM PRODUCTION.CATEGORIES

GROUP BY PRODUCTION.CATEGORIES.CATEGORY_ID, PRODUCTION.CATEGORIES.CATEGORY_NAME

---------- CONSULTA PARA LA TABLA HECHOS_BICICLETAS ------------
SELECT SALES.ORDERS.STAFF_ID, SALES.ORDERS.STORE_ID, SALES.ORDERS.CUSTOMER_ID, SALES.ORDER_ITEMS.PRODUCT_ID, CONVERT(DATE,ORDER_DATE) TIEMPO_ID, 
 
SUM([ORDER_ITEMS].QUANTITY*[ORDER_ITEMS].LIST_PRICE*(1-[ORDER_ITEMS].DISCOUNT)) TOTAL_VENTA_PRODUCTO FROM SALES.ORDERS
INNER JOIN SALES.ORDER_ITEMS ON SALES.ORDERS.ORDER_ID = SALES.ORDER_ITEMS.ORDER_ID
INNER JOIN SALES.STAFFS ON SALES.STAFFS.STAFF_ID = SALES.ORDERS.STAFF_ID
INNER JOIN SALES.STORES ON SALES.STORES.STORE_ID = SALES.ORDERS.STORE_ID 
INNER JOIN SALES.CUSTOMERS ON SALES.CUSTOMERS.CUSTOMER_ID = SALES.ORDERS.CUSTOMER_ID
INNER JOIN PRODUCTION.PRODUCTS ON PRODUCTION.PRODUCTS.PRODUCT_ID = SALES.ORDER_ITEMS.ORDER_ID

GROUP BY SALES.ORDERS.STAFF_ID, SALES.ORDERS.STORE_ID, SALES.ORDERS.CUSTOMER_ID, SALES.ORDER_ITEMS.PRODUCT_ID, ORDER_DATE